<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<!-- ###### start inserted header ##### -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115940772-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-115940772-1');
</script>

<!-- add the twitter card and open graph tags -->
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@djnavarro">
<meta property="og:url" content="http://compcogscisydney.org/psyr/">
<meta property="og:title" content="R for Psychological Science">
<meta property="og:description" content="An introductory resource">
<meta property="og:image" content="http://compcogscisydney.org/psyr/img/splash_turtle.png">

<!-- ###### end inserted header ##### -->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="mystyle.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Psychological Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Core
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="variables.html">Variables</a>
    </li>
    <li>
      <a href="scripts.html">Scripts</a>
    </li>
    <li>
      <a href="packages.html">Packages</a>
    </li>
    <li>
      <a href="workspaces.html">Workspaces</a>
    </li>
    <li>
      <a href="vectors.html">Vectors</a>
    </li>
    <li>
      <a href="loops.html">Loops</a>
    </li>
    <li>
      <a href="branches.html">Branches</a>
    </li>
    <li>
      <a href="functions.html">Functions</a>
    </li>
    <li>
      <a href="programming.html">Programming</a>
    </li>
    <li>
      <a href="file-system.html">File system</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="prelude-to-data.html">Prelude</a>
    </li>
    <li>
      <a href="data-types.html">Data types</a>
    </li>
    <li>
      <a href="describing-data.html">Describing data</a>
    </li>
    <li>
      <a href="visualising-data.html">Visualising data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Stats
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="xx-distributions.html">Probability distributions</a>
    </li>
    <li>
      <a href="xx-introductory-statistics.html">Introductory statistics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="xx-shiny.html">Shiny apps</a>
    </li>
    <li>
      <a href="xx-miscellaneous.html">Miscellaneous</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://compcogscisydney.org">compcogscisydney.org</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore"><ol start="14" style="list-style-type: decimal">
<li>Describing data</li>
</ol></h1>

</div>


<style type="text/css">
h1{
  line-height: 100px;
}
h2{
  line-height: 80px;
}
h3{
  line-height: 60px;
}
</style>
<blockquote>
<p>Out of every hundred people,<br> those who always know better:<br> fifty-two.<br> <br> Unsure of every step:<br> almost all the rest.<br> <br> ¬†¬†¬†¬†¬†¬†- Wislawa Szymborska, <a href="https://www.theatlantic.com/past/docs/unbound/poetry/antholog/szymbors/stats.htm">A Word on Statistics</a> (translated from the Polish by Joanna Trzeciak)</p>
</blockquote>
<!--
> Out of every hundred people,
> those who always know better:
> fifty-two.
> <br>
> Unsure of every step:
> almost all the rest.
> <br>
> Ready to help,
> if it doesn't take long:
> forty-nine.
> <br>
> Always good,
> because they cannot be otherwise:
> four -- well, maybe five.
> <br>
> Able to admire without envy:
> eighteen.
> <br>
> Led to error
> by youth (which passes):
> sixty, plus or minus.
> <br>
> Those not to be messed with:
> four-and-forty.
> <br>
> Living in constant fear
> of someone or something:
> seventy-seven.
> <br>
> Capable of happiness:
> twenty-some-odd at most.
> <br>
> Harmless alone,
> turning savage in crowds:
> more than half, for sure.
> <br>
> Cruel
> when forced by circumstances:
> it's better not to know,
> not even approximately.
> <br>
> Wise in hindsight:
> not many more
> than wise in foresight.
> <br>
> Getting nothing out of life except things:
> thirty
> (though I would like to be wrong).
> <br>
> Balled up in pain
> and without a flashlight in the dark:
> eighty-three, sooner or later.
> <br>
> Those who are just:
> quite a few, thirty-five.
> <br>
> But if it takes effort to understand:
> three.
> <br>
> Worthy of empathy:
> ninety-nine.
> <br>
> Mortal:
> one hundred out of one hundred -- ## 
> a figure that has never varied yet.<br>
> <br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Wislawa Szymborska, [A Word on Statistics](https://www.theatlantic.com/past/docs/unbound/poetry/antholog/szymbors/stats.htm) (translated from the Polish by Joanna Trzeciak)

-->
<p>In this section I‚Äôm going to discuss a few methods for computing different kinds of descriptive statistics in R. I won‚Äôt talk about data visualisation at all until the next section. In the <a href="./prelude-to-data.html">prelude to data</a> section I referred to the AFL data set that contains some information about every game played in the Australian Rules Football (AFL) league between 1987 and 2010, available in the <a href="./data/afl.csv">afl.csv</a> file. As usual, I have <strong>tidyverse</strong> loaded, so I‚Äôll use <code>readr::read_csv</code><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> to import the data:</p>
<pre class="r"><code>afl &lt;- read_csv(&quot;./data/afl.csv&quot;)
afl</code></pre>
<pre><code>## # A tibble: 4,296 x 12
##    home_team away_team home_score away_score  year round weekday   day
##    &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt;      &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;int&gt;
##  1 North Me‚Ä¶ Brisbane         104        137  1987     1 Fri        27
##  2 Western ‚Ä¶ Essendon          62        121  1987     1 Sat        28
##  3 Carlton   Hawthorn         104        149  1987     1 Sat        28
##  4 Collingw‚Ä¶ Sydney            74        165  1987     1 Sat        28
##  5 Melbourne Fitzroy          128         89  1987     1 Sat        28
##  6 St Kilda  Geelong          101        102  1987     1 Sat        28
##  7 West Coa‚Ä¶ Richmond         133        119  1987     1 Sun        29
##  8 North Me‚Ä¶ Melbourne         92         59  1987     2 Fri         3
##  9 Geelong   Brisbane         131        150  1987     2 Sat         4
## 10 Collingw‚Ä¶ Carlton          107        114  1987     2 Sat         4
## # ... with 4,286 more rows, and 4 more variables: month &lt;int&gt;,
## #   game_type &lt;chr&gt;, venue &lt;chr&gt;, attendance &lt;int&gt;</code></pre>
<p>This data frame has 4296 cases and 12 variables, so I definitely don‚Äôt want to be summarising anything manually!</p>
<div id="simple-summaries" class="section level2">
<h2><span class="header-section-number">14.1</span> Simple summaries</h2>
<p>When summarising a variable, there are a variety of different measures that one might want to calculate. Means, medians, standard deviations, skewness, etc. There are so many of these functions out there that I‚Äôd never be able to capture all of them briefly, even restricting ourselves to numeric variables. Here is a quick overview of the most common statistics:</p>
<ul>
<li><code>mean()</code> calculates the arithmetic mean. If you want a trimmed mean it has an optional <code>trim</code> argument</li>
<li><code>median()</code> calculates the median; more generally, the <code>quantile()</code> function computes arbitrary quantiles, specified with the <code>probs</code> argument</li>
<li><code>min()</code> and <code>max()</code> are the minimum and maximum; <code>IQR()</code> returns the interquartile range and <code>range()</code> returns the range</li>
<li><code>sd()</code> calculates the standard deviation (and <code>var()</code> computes the variance)</li>
<li><code>psych::skew()</code> and <code>psych::kurtosi()</code> compute skewness and kurtosis respectively</li>
</ul>
<p>For example, to return the mean and standard deviations for the <code>home_score</code> variable I would use these commands:</p>
<pre class="r"><code>mean(afl$home_score)</code></pre>
<pre><code>## [1] 101.5084</code></pre>
<pre class="r"><code>sd(afl$home_score)</code></pre>
<pre><code>## [1] 29.65969</code></pre>
<p>It‚Äôs worth noting that many of these functions have an <code>na.rm</code> argument (or similar) that specifies how R will handle missing data (i.e., <code>NA</code> values). Quite often, the default is to set <code>na.rm = FALSE</code> meaning that R will not remove missing cases. That can be useful as a way of discovering that your data has missing values: if one of the values is missing then by definition the mean of all your values must also be missing!</p>
<pre class="r"><code>age &lt;- c(21, 19, 39, NA, 56)
mean(age)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>In practice though it‚Äôs often more an annoyance than an aid, so you‚Äôll often want to calculate the mean like this:</p>
<pre class="r"><code>mean(age, na.rm = TRUE)</code></pre>
<pre><code>## [1] 33.75</code></pre>
</div>
<div id="correlations" class="section level2">
<h2><span class="header-section-number">14.2</span> Correlations</h2>
<p>For a pair of numeric variables, we often want to report the strength and direction of correlations. The <code>cor</code> function does this, and by default it reports the Pearson correlation:</p>
<pre class="r"><code>cor(afl$home_score, afl$away_score)</code></pre>
<pre><code>## [1] -0.1413139</code></pre>
<p>As an aside, I don‚Äôt like writing the name of the data frame twice within the same command. It‚Äôs a visual distraction and (in my opinion!) it makes the code harder to read. The <strong>magrittr</strong> package solves this for us. In addition to being the origin of the standard R pipe <code>%&gt;%</code>, it contains the <code>%$%</code> operator that ‚Äúexposes‚Äù the names of the variables inside a data frame to another function. So lets load the package:</p>
<pre class="r"><code>library(magrittr)</code></pre>
<p>Now here‚Äôs how I would compute the same correlation using <code>%$%</code>:</p>
<pre class="r"><code>afl %$% cor(home_score, away_score)</code></pre>
<pre><code>## [1] -0.1413139</code></pre>
<p>In one sense the difference is purely aesthetic, but aesthetics really do matter when analysing data. In the piped version, I have the name of the data set on the left, and the thing that I‚Äôm calculating from it on the right. That feels intuitive and ‚Äúnormal‚Äù to me. The original command mixes everything together and I find myself struggling to read it properly.</p>
<p>Regardless of which version you prefer, you‚Äôll be pleased to know that the <code>cor</code> function has a <code>method</code> argument that lets you specify whether to calculate the <code>pearson</code> correlation (the default), the <code>spearman</code> rank-sum correlation, or the <code>kendall</code> tau measure. For instance:</p>
<pre class="r"><code>afl %$% cor(home_score, away_score, method = &quot;spearman&quot;)</code></pre>
<pre><code>## [1] -0.1406248</code></pre>
<p>A couple of other things to mention about correlations.</p>
<ul>
<li>The <code>cor.test</code> function allows you to conduct a hypothesis test for whether a correlation is statistically significant.</li>
<li>The <code>cor</code> function can take a matrix or data frame as input, but it will produce an error if any of the variables are non-numeric. I‚Äôve used the <code>lsr::correlate</code> function to make my life a little easier in this respect, so if I want a correlation matrix that only considers the numeric variables <code>lsr::correlate(afl)</code> works</li>
<li>The <code>cor</code> function doesn‚Äôt handle situations where one or more variables are categorical. The <strong>psych</strong> package has a variety of tools that will solve this for you. It includes functions <code>tetrachoric</code>, <code>polychoric</code>, <code>biserial</code> and <code>polyserial</code> to handle those situations. I won‚Äôt describe those here - I just want to mention them in case you need them later!</li>
</ul>
</div>
<div id="frequency-tables" class="section level2">
<h2><span class="header-section-number">14.3</span> Frequency tables</h2>
<p>For categorical variables, where you usually want a table of frequencies that tallies the number of times each value appears, the <code>table</code> function is your friend:<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<pre class="r"><code>afl %$% table(weekday)</code></pre>
<pre><code>## weekday
##  Fri  Mon  Sat  Sun  Thu  Tue  Wed 
##  514   98 2226 1421   25    6    6</code></pre>
<p>Not surprisingly, most football games are played on the weekend. The <code>table</code> function is quite flexible, and allows you to compute cross-tabulations between two, three, or more variables simply by adding more variable names. As an example, here is the cross tabulation of <code>year</code> by <code>weekday</code>:</p>
<pre class="r"><code>afl %$% table(year, weekday)</code></pre>
<pre><code>##       weekday
## year   Fri Mon Sat Sun Thu Tue Wed
##   1987  18   7 120  34   0   0   0
##   1988  18   8  99  35   0   0   0
##   1989  15   2 103  38   0   2   0
##   1990  13   6 103  37   0   0   2
##   1991  14   6 101  49   2   0   0
##   1992  15   4  94  58   1   0   0
##   1993  19   5  83  50   0   0   0
##   1994  15   5  90  64   0   0   0
BLAH BLAH BLAH</code></pre>
</div>
<div id="summarising-by-group" class="section level2">
<h2><span class="header-section-number">14.4</span> Summarising by group</h2>
<p>Back in the dark pre-<strong>tidyverse</strong> era it was surprisingly difficult to compute descriptive statistics separately for each group. There is a function in base R called <code>aggregate()</code> that lets you do this, but it‚Äôs a little cumbersome. The way I usually do this now is with the <strong>dplyr</strong> functions <code>group_by()</code> and <code>summarise()</code>. Let‚Äôs suppose I want to compute the mean attendance at AFL games broken down by who was playing. Conceptually, what I want to do is <em>‚Äúgroup by‚Äù</em> two variables namely <code>home_team</code> and <code>away_team</code>, and <em>‚Äúthen‚Äù</em> for all unique combinations of those variables <em>‚Äúsummarise‚Äù</em> the data by computing the mean <code>attendance</code>. That sounds like a job for <code>%&gt;%</code>‚Ä¶</p>
<pre class="r"><code>match_popularity &lt;- afl %&gt;%
  group_by(home_team, away_team) %&gt;%
  summarise(attend = mean(attendance))</code></pre>
<p>The call to <code>group_by()</code> creates a ‚Äúgrouped data frame‚Äù which doesn‚Äôt look any different to the original <em>other</em> than that R now knows what grouping you want! When this grouped data is piped to <code>summarise()</code>, R knows that it is supposed to provide results broken down by the relevant grouping variables. So this is what the command above returns:</p>
<pre class="r"><code>match_popularity</code></pre>
<pre><code>## # A tibble: 270 x 3
## # Groups:   home_team [?]
##    home_team away_team       attend
##    &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt;
##  1 Adelaide  Brisbane        38638.
##  2 Adelaide  Carlton         42256.
##  3 Adelaide  Collingwood     42205.
##  4 Adelaide  Essendon        42570.
##  5 Adelaide  Fitzroy         36204 
##  6 Adelaide  Fremantle       40030.
##  7 Adelaide  Geelong         42588.
##  8 Adelaide  Hawthorn        41932.
##  9 Adelaide  Melbourne       40050.
## 10 Adelaide  North Melbourne 42553.
## # ... with 260 more rows</code></pre>
<p>In the first row, we see that the average attendance at a match between Adelaide and Brisbane over this period was about 39,000 people.</p>
</div>
<div id="arranging-data" class="section level2">
<h2><span class="header-section-number">14.5</span> Arranging data</h2>
<p>The output from our previous command organised the output alphabetically, which is less than ideal. It is usually more helpful to sort the data set in a more meaningful way using <code>dplyr::arrange</code>. To sort the <code>match_popularity</code> table in order of increasing attendance, we do this:</p>
<pre class="r"><code>match_popularity %&gt;%
  arrange(attend)</code></pre>
<pre><code>## # A tibble: 270 x 3
## # Groups:   home_team [17]
##    home_team away_team       attend
##    &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt;
##  1 Fitzroy   Fremantle        6322 
##  2 Fitzroy   Brisbane         6787.
##  3 Fitzroy   West Coast       7139 
##  4 Fitzroy   Adelaide         8491 
##  5 Brisbane  Fitzroy          9426.
##  6 Fitzroy   Sydney           9681.
##  7 Fitzroy   North Melbourne 10352 
##  8 Sydney    Fitzroy         10710.
##  9 Fitzroy   Melbourne       10890 
## 10 Fitzroy   Geelong         10951.
## # ... with 260 more rows</code></pre>
<p>Clearly, Fitzroy was not a popular team, which would be the reason they were merged with Brisbane in 1996. To sort in descending order we can do this:</p>
<pre class="r"><code>match_popularity %&gt;%
  arrange(-attend)</code></pre>
<pre><code>## # A tibble: 270 x 3
## # Groups:   home_team [17]
##    home_team   away_team   attend
##    &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
##  1 Collingwood Essendon    73243.
##  2 Collingwood Carlton     68955.
##  3 Essendon    Collingwood 66756 
##  4 Carlton     Collingwood 64162.
##  5 Melbourne   Collingwood 60705.
##  6 Essendon    Carlton     58752.
##  7 Carlton     Essendon    55901.
##  8 Collingwood Geelong     55818.
##  9 Richmond    Collingwood 55218.
## 10 Richmond    Essendon    54450.
## # ... with 260 more rows</code></pre>
<p>Sigh. Collingwood. It‚Äôs always Collingwood. Moving on.</p>
</div>
<div id="filtering-cases" class="section level2">
<h2><span class="header-section-number">14.6</span> Filtering cases</h2>
<p>How bad was the situation for Fitzroy? Suppose I just want to look at <code>match_popularity</code> for Fitzroy home games. The <code>dplyr::filter</code> command lets you do this:</p>
<pre class="r"><code>match_popularity %&gt;%
  filter(home_team == &quot;Fitzroy&quot;)</code></pre>
<pre><code>## # A tibble: 15 x 3
## # Groups:   home_team [1]
##    home_team away_team        attend
##    &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;
##  1 Fitzroy   Adelaide          8491 
##  2 Fitzroy   Brisbane          6787.
##  3 Fitzroy   Carlton          17811 
##  4 Fitzroy   Collingwood      21677.
##  5 Fitzroy   Essendon         16550.
##  6 Fitzroy   Fremantle         6322 
##  7 Fitzroy   Geelong          10951.
##  8 Fitzroy   Hawthorn         13399.
##  9 Fitzroy   Melbourne        10890 
## 10 Fitzroy   North Melbourne  10352 
## 11 Fitzroy   Richmond         11187.
## 12 Fitzroy   St Kilda         13565 
## 13 Fitzroy   Sydney            9681.
## 14 Fitzroy   West Coast        7139 
## 15 Fitzroy   Western Bulldogs 13287.</code></pre>
<p>The <code>filter</code> function can handle more complex logical expressions too. To capture all matches where Fitzroy were playing, regardless of whether they were home or away, a command like this will work:</p>
<pre class="r"><code>match_popularity %&gt;%
  filter(home_team==&quot;Fitzroy&quot; | away_team ==&quot;Fitzroy&quot;)</code></pre>
<p>However, because this will return a table with 30 rows, R will truncate the output by default. That‚Äôs mildly annoying in this situation. I‚Äôd like to see all the results, preferably sorted in a sensible fashion. To sort the outout we pipe the results to <code>arrange</code>, exactly as we did previously, and to ensure that all the rows are printed we can pipe that to an explicit call to <code>print</code> that specifies the number of rows to show. Here‚Äôs the output:</p>
<pre class="r"><code>match_popularity %&gt;%
  filter(home_team==&quot;Fitzroy&quot; | away_team ==&quot;Fitzroy&quot;) %&gt;%
  arrange(attend) %&gt;%
  print(n = 30)</code></pre>
<pre><code>## # A tibble: 30 x 3
## # Groups:   home_team [16]
##    home_team        away_team        attend
##    &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;
##  1 Fitzroy          Fremantle         6322 
##  2 Fitzroy          Brisbane          6787.
##  3 Fitzroy          West Coast        7139 
##  4 Fitzroy          Adelaide          8491 
##  5 Brisbane         Fitzroy           9426.
##  6 Fitzroy          Sydney            9681.
##  7 Fitzroy          North Melbourne  10352 
##  8 Sydney           Fitzroy          10710.
##  9 Fitzroy          Melbourne        10890 
## 10 Fitzroy          Geelong          10951.
## 11 Fitzroy          Richmond         11187.
## 12 Western Bulldogs Fitzroy          12935.
## 13 Fitzroy          Western Bulldogs 13287.
## 14 Fitzroy          Hawthorn         13399.
## 15 Fitzroy          St Kilda         13565 
## 16 North Melbourne  Fitzroy          15861.
## 17 Hawthorn         Fitzroy          15871.
## 18 Fitzroy          Essendon         16550.
## 19 Fitzroy          Carlton          17811 
## 20 Geelong          Fitzroy          18256.
## 21 St Kilda         Fitzroy          18263.
## 22 Carlton          Fitzroy          19742.
## 23 Melbourne        Fitzroy          20073 
## 24 West Coast       Fitzroy          20738.
## 25 Fremantle        Fitzroy          21324.
## 26 Fitzroy          Collingwood      21677.
## 27 Essendon         Fitzroy          22906.
## 28 Collingwood      Fitzroy          22911.
## 29 Richmond         Fitzroy          23007.
## 30 Adelaide         Fitzroy          36204</code></pre>
<p>Poor Fitzroy üòû</p>
</div>
<div id="selecting-variables" class="section level2">
<h2><span class="header-section-number">14.7</span> Selecting variables</h2>
<p>Many data analysis situations present you with a <em>lot</em> of variables to work with, and you might need to <code>select</code> a few variables to look at. It‚Äôs not such a big deal for the AFL data as there are only 12 variables in the raw data, but even there when we print out the tibble it doesn‚Äôt show us all the cases. Let‚Äôs suppose we have simple problem where what we want to do is extract the fixture for round 1 of the 1994 season. That is, the only thing we want is the name of the teams playing, the venue and the weekday:</p>
<pre class="r"><code>afl %&gt;%
  filter(year == 1994 &amp; round == 1) %&gt;%
  select(home_team, away_team, venue, weekday)</code></pre>
<pre><code>## # A tibble: 7 x 4
##   home_team        away_team  venue         weekday
##   &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;         &lt;chr&gt;  
## 1 Western Bulldogs Richmond   Western Oval  Sat    
## 2 Essendon         West Coast MCG           Sat    
## 3 Collingwood      Fitzroy    Victoria Park Sat    
## 4 St Kilda         Hawthorn   Waverley Park Sat    
## 5 Brisbane         Sydney     Gabba         Sun    
## 6 Adelaide         Carlton    AAMI Stadium  Sun    
## 7 Melbourne        Geelong    MCG           Sun</code></pre>
<p>Well that was easy!</p>
</div>
<div id="new-variables-with-mutate" class="section level2">
<h2><span class="header-section-number">14.8</span> New variables with mutate</h2>
<p>Very often the raw data you are given doesn‚Äôt contain the actual quantity of iteres, and you might need to compute it from the other variables. The <code>mutate</code> function allows you to create new variables within a data frame:</p>
<pre class="r"><code>afl %&gt;%
  mutate(margin = abs(home_score - away_score)) %&gt;%
  select(home_score, away_score, margin)</code></pre>
<pre><code>## # A tibble: 4,296 x 3
##    home_score away_score margin
##         &lt;int&gt;      &lt;int&gt;  &lt;int&gt;
##  1        104        137     33
##  2         62        121     59
##  3        104        149     45
##  4         74        165     91
##  5        128         89     39
##  6        101        102      1
##  7        133        119     14
##  8         92         59     33
##  9        131        150     19
## 10        107        114      7
## # ... with 4,286 more rows</code></pre>
<p>where the <code>select</code> command is just for visual clarity in the output! As always, remember that if you want to store the new variable you need to assign the result to a variable.</p>
<!--
## "Skimming" a data set




```r
library(skimr)
skim(afl)
```

```
## Skim summary statistics
##  n obs: 4296 
##  n variables: 12 
## 
## ‚îÄ‚îÄ Variable type:character ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##   variable missing complete    n min max empty n_unique
##  away_team       0     4296 4296   6  16     0       17
##  game_type       0     4296 4296   6   7     0        2
##  home_team       0     4296 4296   6  16     0       17
##      venue       0     4296 4296   3  18     0       20
##    weekday       0     4296 4296   3   3     0        7
## 
## ‚îÄ‚îÄ Variable type:integer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##    variable missing complete    n     mean       sd   p0      p25     p50
##  attendance       0     4296 4296 32095.22 16645.75 3059 20400.75 29209.5
##  away_score       0     4296 4296    91.12    29.03   13    71       89  
##         day       0     4296 4296    15.86     9.02    1     8       16  
##  home_score       0     4296 4296   101.51    29.66   14    80       99  
##       month       0     4296 4296     6.06     1.66    3     5        6  
##       round       0     4296 4296    12.2      6.72    1     6       12  
##        year       0     4296 4296  1998.77     6.87 1987  1993     1999  
##       p75  p100     hist
##  40265.25 1e+05 ‚ñÉ‚ñá‚ñá‚ñÖ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
##    108      239 ‚ñÅ‚ñÖ‚ñá‚ñÜ‚ñÇ‚ñÅ‚ñÅ‚ñÅ
##     24       31 ‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñá
##    120      236 ‚ñÅ‚ñÉ‚ñá‚ñá‚ñÉ‚ñÅ‚ñÅ‚ñÅ
##      7       10 ‚ñÇ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñÇ‚ñÅ
##     18       25 ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÇ
##   2005     2010 ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá
```


-->
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>A quick explanation if you‚Äôre unfamiliar with the <code>::</code> operator. It‚Äôs a tool you can use to referring to a function inside a package regardless of whether that package is loaded. So <code>readr::read_csv</code> means ‚Äúuse the <code>read_csv</code> function in the <strong>readr</strong> package‚Äù. In this instance <strong>readr</strong> is loaded via <strong>tidyverse</strong> so my actual command doesn‚Äôt use <code>::</code>. However, what you see a lot of people doing in textbooks or online is use this notation as a shorthand way to tell people <em>where</em> the function is located. The further we go into these notes the more likely I am to start doing that. It‚Äôs a pretty convenient way of talking about these things!<a href="#fnref1">‚Ü©</a></p></li>
<li id="fn2"><p>Note that in this output the weekdays are printed alphabetically rather than in a sensible order. That‚Äôs because I imported the data straight from a CSV file and I haven‚Äôt taken the time to convery <code>weekday</code> to a factor (see the <a href="./data-types.html">data types</a> section). You can reorder the levels of a factor however you like. I wrote my own function <code>lsr::permuteLevels</code> that does this; there‚Äôs also the <code>forcats::fct_relevel</code> function and the simpler <code>relevel</code> function in base R that helps with this. I‚Äôll talk more about this later.<a href="#fnref2">‚Ü©</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
