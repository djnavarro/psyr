<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>working-with-text.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<!-- ###### start inserted header ##### -->

<!-- add plausible.io -->
<script async defer data-domain="psyr.djnavarro.net" src="https://plausible.io/js/plausible.js"></script>

<!-- add fontawesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

<!-- add the twitter card and open graph tags -->
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@djnavarro">
<meta property="og:url" content="https://psyr.org">
<meta property="og:title" content="R for Psychological Science">
<meta property="og:description" content="An introductory resource">
<meta property="og:image" content="http://psyr.org/img/splash_turtle.png">

<!-- ###### end inserted header ##### -->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="mystyle.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Psychological Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Core
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="variables.html">Variables</a>
    </li>
    <li>
      <a href="scripts.html">Scripts</a>
    </li>
    <li>
      <a href="packages.html">Packages</a>
    </li>
    <li>
      <a href="workspaces.html">Workspaces</a>
    </li>
    <li>
      <a href="vectors.html">Vectors</a>
    </li>
    <li>
      <a href="loops.html">Loops</a>
    </li>
    <li>
      <a href="branches.html">Branches</a>
    </li>
    <li>
      <a href="functions.html">Functions</a>
    </li>
    <li>
      <a href="programming.html">Programming</a>
    </li>
    <li>
      <a href="file-system.html">File system</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="prelude-to-data.html">Prelude</a>
    </li>
    <li>
      <a href="data-types.html">Data types</a>
    </li>
    <li>
      <a href="describing-data.html">Describing data</a>
    </li>
    <li>
      <a href="visualising-data.html">Visualising data</a>
    </li>
    <li>
      <a href="manipulating-data.html">Manipulating data</a>
    </li>
    <li>
      <a href="working-with-text.html">Text data</a>
    </li>
    <li>
      <a href="import-export.html">Import/export</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Stats
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="probability.html">Probability distributions</a>
    </li>
    <li>
      <a href="introductory-statistics.html">Introductory statistics</a>
    </li>
    <li>
      <a href="intermediate-statistics.html">Intermediate statistics</a>
    </li>
    <li>
      <a href="advanced-statistics.html">Advanced statistics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="experiments.html">Experiments</a>
    </li>
    <li>
      <a href="shiny.html">Shiny apps</a>
    </li>
    <li>
      <a href="web-scraping.html">Web scraping</a>
    </li>
    <li>
      <a href="xx-miscellaneous.html">Miscellaneous</a>
    </li>
    <li>
      <a href="backprop.html">Backpropagation networks</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://compcogscisydney.org">compcogscisydney.org</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<style type="text/css">
h1{
  line-height: 100px;
}
h2{
  line-height: 80px;
}
h3{
  line-height: 60px;
}
</style>
<p>Sometimes your data set is quite text heavy. This can be for a lot of different reasons. Maybe the raw data are actually taken from text sources (e.g., newspaper articles), or maybe your data set contains a lot of free responses to survey questions. Or maybe you just need to reorganise some of the text used to describe nominal scale variables. Regardless of what the reason is, you’ll probably want to know a little bit about how to handle text in R. A few minor examples of this have appeared earlier in these notes (e.g., using <code>nchar()</code> to calculate the number of characters in a string). When I wrote <em>Learning Statistics with R</em> I included some notes on how to work with text using base R, but overall I’ve come to the view that the tidyverse approach provided via the <strong>stringr</strong> package is a little more coherent and less problematic for new users, so I’ll take that approach here.</p>
<div id="preliminaries" class="section level2">
<h2><span class="header-section-number">17.1</span> Preliminaries</h2>
<ul>
<li><code>print</code></li>
<li><code>cat</code></li>
<li>escaping</li>
</ul>
</div>
<div id="getting-started" class="section level2">
<h2><span class="header-section-number">17.2</span> Getting started</h2>
<p>The data come from Experiment 1 in a <a href="https://doi.org/10.1073/pnas.0707835105">very cool paper</a> by Simon Kirby, Hannah Cornish, and Kenny Smith.</p>
<pre class="r"><code>chains &lt;- read_csv(&quot;./data/kirbyetal2008_exp1_wide.csv&quot;)
chain_3 &lt;- chains %&gt;% 
  filter(version == &quot;chain3&quot;) %&gt;%
  select(color,shape,motion,starts_with(&quot;name&quot;)) 
print(chain_3)</code></pre>
<pre><code>## # A tibble: 27 x 14
##    color shape  motion name_0 name_1 name_2 name_3 name_4 name_5
##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
##  1 black circle bounce kinim… kimei  hepini tuge   tupim  tupim 
##  2 blue  circle bounce wikuki miwn   miniku tupim  tupim  tupim 
##  3 red   circle bounce kikumi mihen… hepini tupim  tupim  tupim 
##  4 black square bounce miwin… pemini nige   miniku mihunu mihunu
##  5 blue  square bounce pinipi kupini tuge   tuge   tupim  tupim 
##  6 red   square bounce kihem… pon    mihenu mihunu miniku tupim 
##  7 black trian… bounce miwimi poi    poi    poi    poi    miniku
##  8 blue  trian… bounce nipi   mhip   mpo    tuge   miniku tupim 
##  9 red   trian… bounce wige   kuwpi  tupim  miniku miniku miniku
## 10 black circle horiz… nihepi mip    nige   tuge   tuge   tuge  
## # … with 17 more rows, and 5 more variables: name_6 &lt;chr&gt;,
## #   name_7 &lt;chr&gt;, name_8 &lt;chr&gt;, name_9 &lt;chr&gt;, name_10 &lt;chr&gt;</code></pre>
<pre class="r"><code>input &lt;- chain_3$name_0
output &lt;- chain_3$name_10</code></pre>
<p>Excellent! I have a data set ✅ Next, I’ll need a string manipulation package. <strong>stringr</strong> is loaded automatically with <strong>tidyverse</strong> so that’s another ✅. Time to get started!</p>
</div>
<div id="flatten-strings" class="section level2">
<h2><span class="header-section-number">17.3</span> Flatten strings</h2>
<p>Our first job might be just to visually inspect the words that appear in the <code>output</code> of the iterated learning chain, and compare them to the words that were present in the <code>input</code>. To make things easier on ourselves, we’ll use the <code>str_flatten()</code> function to <em>flatten</em> each of these vectors to a single string. We’ll specify <code>collapse = ", "</code> so that the output takes the form of a nice comma-separated list of words</p>
<pre class="r"><code>input %&gt;% str_flatten(collapse = &quot;, &quot;)</code></pre>
<pre><code>## [1] &quot;kinimapi, wikuki, kikumi, miwiniku, pinipi, kihemiwi, miwimi, nipi, wige, nihepi, wigemi, mahekuki, wimaku, miniki, gepinini, wikima, nipikuge, hema, pikuhemi, kimaki, pimikihe, gepihemi, kunige, miki, mihe, winige, kinimage&quot;</code></pre>
<pre class="r"><code>output %&gt;% str_flatten(collapse = &quot;, &quot;)</code></pre>
<pre><code>## [1] &quot;miniku, miniku, miniku, tupim, tupim, tupim, tupin, tupin, tupin, tuge, tuge, tuge, tuge, tuge, tuge, tuge, tuge, tuge, poi, poi, poi, poi, poi, poi, poi, poi, poi&quot;</code></pre>
</div>
<div id="string-length" class="section level2">
<h2><span class="header-section-number">17.4</span> String length</h2>
<p>The one of the first things I notice when looking at this output is that they’re rather different in length. Even though there are 27 words in each list, it looks like the <code>output</code> words are shorter. We can check this by using the <code>str_length()</code> function to compute the length of each word.</p>
<pre class="r"><code>input %&gt;% str_length() </code></pre>
<pre><code>##  [1] 8 6 6 8 6 8 6 4 4 6 6 8 6 6 8 6 8 4 8 6 8 8 6 4 4 6 8</code></pre>
<pre class="r"><code>output %&gt;% str_length()</code></pre>
<pre><code>##  [1] 6 6 6 5 5 5 5 5 5 4 4 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3</code></pre>
</div>
<div id="substrings" class="section level2">
<h2><span class="header-section-number">17.5</span> Substrings</h2>
<p>One thing I might be interested in, either for theoretical reasons (e.g., looking for meaningful prefixes) or practical ones (e.g., convenient plot labels) is extract a smaller subset of the string. A common example is to take the first three characters. We can do this using <code>str_sub()</code></p>
<pre class="r"><code>output %&gt;% str_sub(start = 1, end = 3)</code></pre>
<pre><code>##  [1] &quot;min&quot; &quot;min&quot; &quot;min&quot; &quot;tup&quot; &quot;tup&quot; &quot;tup&quot; &quot;tup&quot; &quot;tup&quot; &quot;tup&quot; &quot;tug&quot;
## [11] &quot;tug&quot; &quot;tug&quot; &quot;tug&quot; &quot;tug&quot; &quot;tug&quot; &quot;tug&quot; &quot;tug&quot; &quot;tug&quot; &quot;poi&quot; &quot;poi&quot;
## [21] &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot;</code></pre>
<p>A feature of <code>str_sub</code> that sometimes comes in handy is that you can specify negative values here to refer to the distance from the end of the string. If for instance I wanted to extract the last three characters in every word:</p>
<pre class="r"><code>output %&gt;% str_sub(start = -3, end = -1)</code></pre>
<pre><code>##  [1] &quot;iku&quot; &quot;iku&quot; &quot;iku&quot; &quot;pim&quot; &quot;pim&quot; &quot;pim&quot; &quot;pin&quot; &quot;pin&quot; &quot;pin&quot; &quot;uge&quot;
## [11] &quot;uge&quot; &quot;uge&quot; &quot;uge&quot; &quot;uge&quot; &quot;uge&quot; &quot;uge&quot; &quot;uge&quot; &quot;uge&quot; &quot;poi&quot; &quot;poi&quot;
## [21] &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot; &quot;poi&quot;</code></pre>
</div>
<div id="duplication" class="section level2">
<h2><span class="header-section-number">17.6</span> Duplication</h2>
<p>I’m not sure why I would want it in this context, but we can duplicate strings using <code>str_dup()</code></p>
<pre class="r"><code>output %&gt;% str_dup(times = 3)</code></pre>
<pre><code>##  [1] &quot;minikuminikuminiku&quot; &quot;minikuminikuminiku&quot;
##  [3] &quot;minikuminikuminiku&quot; &quot;tupimtupimtupim&quot;   
##  [5] &quot;tupimtupimtupim&quot;    &quot;tupimtupimtupim&quot;   
##  [7] &quot;tupintupintupin&quot;    &quot;tupintupintupin&quot;   
##  [9] &quot;tupintupintupin&quot;    &quot;tugetugetuge&quot;      
## [11] &quot;tugetugetuge&quot;       &quot;tugetugetuge&quot;      
## [13] &quot;tugetugetuge&quot;       &quot;tugetugetuge&quot;      
## [15] &quot;tugetugetuge&quot;       &quot;tugetugetuge&quot;      
## [17] &quot;tugetugetuge&quot;       &quot;tugetugetuge&quot;      
## [19] &quot;poipoipoi&quot;          &quot;poipoipoi&quot;         
## [21] &quot;poipoipoi&quot;          &quot;poipoipoi&quot;         
## [23] &quot;poipoipoi&quot;          &quot;poipoipoi&quot;         
## [25] &quot;poipoipoi&quot;          &quot;poipoipoi&quot;         
## [27] &quot;poipoipoi&quot;</code></pre>
</div>
<div id="truncation-and-padding" class="section level2">
<h2><span class="header-section-number">17.7</span> Truncation and padding</h2>
<p>Sometimes it is useful to ensure that every string has the same length. Again, this can be quite useful when labelling data. For longer strings we might need to truncate it using <code>str_trunc()</code> and for shorter strings we might need to pad it with whitespace (or other characters) using <code>str_pad()</code>. To give a sense of this:</p>
<pre class="r"><code>str_pad(string = &quot;Danielle&quot;, width = 20)
str_pad(string = &quot;Danielle&quot;, width = 20, side = &quot;right&quot;)
str_pad(string = &quot;Danielle&quot;, width = 20, side = &quot;both&quot;)
str_pad(string = &quot;Danielle&quot;, width = 20, side = &quot;both&quot;, pad = &quot;-&quot;)</code></pre>
<pre><code>## [1] &quot;            Danielle&quot;
## [1] &quot;Danielle            &quot;
## [1] &quot;      Danielle      &quot;
## [1] &quot;------Danielle------&quot;</code></pre>
<pre class="r"><code>str_trunc(string = &quot;Danielle&quot;, width = 9)
str_trunc(string = &quot;Danielle&quot;, width = 8)
str_trunc(string = &quot;Danielle&quot;, width = 7)
str_trunc(string = &quot;Danielle&quot;, width = 7, ellipsis = &quot;+++&quot;)</code></pre>
<pre><code>## [1] &quot;Danielle&quot;
## [1] &quot;Danielle&quot;
## [1] &quot;Dani...&quot;
## [1] &quot;Dani+++&quot;</code></pre>
<p>Truncation and padding work very nicely together:</p>
<pre class="r"><code>input %&gt;% 
  str_pad(width = 7, side = &quot;right&quot;) %&gt;%
  str_trunc(width = 7)</code></pre>
<pre><code>##  [1] &quot;kini...&quot; &quot;wikuki &quot; &quot;kikumi &quot; &quot;miwi...&quot; &quot;pinipi &quot; &quot;kihe...&quot;
##  [7] &quot;miwimi &quot; &quot;nipi   &quot; &quot;wige   &quot; &quot;nihepi &quot; &quot;wigemi &quot; &quot;mahe...&quot;
## [13] &quot;wimaku &quot; &quot;miniki &quot; &quot;gepi...&quot; &quot;wikima &quot; &quot;nipi...&quot; &quot;hema   &quot;
## [19] &quot;piku...&quot; &quot;kimaki &quot; &quot;pimi...&quot; &quot;gepi...&quot; &quot;kunige &quot; &quot;miki   &quot;
## [25] &quot;mihe   &quot; &quot;winige &quot; &quot;kini...&quot;</code></pre>
</div>
<div id="removing-whitespace" class="section level2">
<h2><span class="header-section-number">17.8</span> Removing whitespace</h2>
<p>A common problem when dealing with text is white space that appears in the wrong place. For example, suppose someone intended to type the words <em>tupim</em>, <em>tupin</em> and <em>poi</em> as part of the experiment but ended up with additional spaces, leading to this as the raw data:</p>
<pre class="r"><code>raw &lt;- &quot;  tupim   tupin    poi    &quot;</code></pre>
<p>The <code>str_trim()</code> function removes all leading and trailing whitespace; <code>str_squish()</code> does the same but also compresses any internal whitespace to a single character. Thus:</p>
<pre class="r"><code>raw
raw %&gt;% str_trim()
raw %&gt;% str_squish()</code></pre>
<pre><code>## [1] &quot;  tupim   tupin    poi    &quot;
## [1] &quot;tupim   tupin    poi&quot;
## [1] &quot;tupim tupin poi&quot;</code></pre>
</div>
<div id="wrapping-strings" class="section level2">
<h2><span class="header-section-number">17.9</span> Wrapping strings</h2>
<pre class="r"><code>input %&gt;% 
  str_flatten(&quot;, &quot;) %&gt;% 
  str_wrap(width = 30, indent = 5, exdent = 3) %&gt;% 
  cat()</code></pre>
<pre><code>##      kinimapi, wikuki, kikumi,
##    miwiniku, pinipi, kihemiwi,
##    miwimi, nipi, wige, nihepi,
##    wigemi, mahekuki, wimaku,
##    miniki, gepinini, wikima,
##    nipikuge, hema, pikuhemi,
##    kimaki, pimikihe, gepihemi,
##    kunige, miki, mihe, winige,
##    kinimage</code></pre>
</div>
<div id="sorting-strings" class="section level2">
<h2><span class="header-section-number">17.10</span> Sorting strings</h2>
<p>There are a collection of functions that manipulate properties of text that vary from one language to the next. The order in which letters appear in the alphabet isn’t always the same, for example. These functions all have a <code>locale</code> value that is set to <code>"en"</code> by default.</p>
<pre class="r"><code>letters %&gt;% str_sort(locale = &quot;en&quot;) %&gt;% str_flatten()
letters %&gt;% str_sort(locale = &quot;haw&quot;) %&gt;% str_flatten()</code></pre>
<pre><code>## [1] &quot;abcdefghijklmnopqrstuvwxyz&quot;
## [1] &quot;aeioubcdfghjklmnpqrstvwxyz&quot;</code></pre>
<p>There is also a <code>str_order()</code> function that returns a numeric vector indicating the order in which the original input should be shuffled to produce a sorted output.</p>
</div>
<div id="changing-case" class="section level2">
<h2><span class="header-section-number">17.11</span> Changing case</h2>
<p>For dealing with upper and lower case:</p>
<pre class="r"><code>&quot;DANIELLE navarro&quot; %&gt;% str_to_lower()
&quot;DANIELLE navarro&quot; %&gt;% str_to_upper()
&quot;DANIELLE navarro&quot; %&gt;% str_to_title()</code></pre>
<pre><code>## [1] &quot;danielle navarro&quot;
## [1] &quot;DANIELLE NAVARRO&quot;
## [1] &quot;Danielle Navarro&quot;</code></pre>
<p>Note that these are also locale sensitive: the precise mappings that determine what counts as upper and lower case aren’t the same in different languages.</p>
</div>
<div id="pattern-matching" class="section level2">
<h2><span class="header-section-number">17.12</span> Pattern matching</h2>
<p>Many text processing tasks require us to solve <em>pattern matching</em> problems. This might be something simple like finding every instance of the word <code>"hello"</code> or something more complicated like extracting every email address from a messy web page. The approach taken in <strong>stringr</strong> is to make a conceptual distinction between functions that allow you to perform <em>tasks</em>, and functions that specify pattern matching <em>engines</em>.</p>
<div id="tasks" class="section level3">
<h3><span class="header-section-number">17.12.1</span> Tasks</h3>
<p>There are many different tasks that you can solve using pattern matching methods and as a result there are many different pattern matching functions. This isn’t a complete listing of the functions in <strong>stringr</strong> that you can use for this, but it covers most of the main ones:</p>
<ul>
<li><code>str_split</code> breaks a string by a separating character</li>
<li><code>str_count</code> counts the number of times a string matches a pattern</li>
<li><code>str_detect</code> and <code>str_subset</code> finds strings that match a pattern</li>
<li><code>str_locate</code> finds the position of the first pattern match in a string</li>
<li><code>str_locate_all</code> finds the positions of all matches</li>
<li><code>str_extract</code> returns the first match in a string (see also <code>str_match</code>)</li>
<li><code>str_extract_all</code> returns all matches in a string (see also <code>str_match_all</code>)</li>
<li><code>str_remove</code> deletes the first part of a string that matches a pattern</li>
<li><code>str_remove_all</code> deletes all parts of a string that match a pattern</li>
<li><code>str_replace</code> and <code>str_replace_all</code> allow you to make substitutions</li>
</ul>
<p>I’ll go into a little more detail on these shortly.</p>
</div>
<div id="engines" class="section level3">
<h3><span class="header-section-number">17.12.2</span> Engines</h3>
<p>The thing I really like, though, is the fact that the <em>engine</em> that defines what counts as a pattern is broken up into convenience functions:</p>
<ul>
<li>A <code>fixed</code> pattern is the simplest type: it matches an exact pattern</li>
<li>A <code>coll</code> pattern is similar, but recognises that the same character can be represented in different ways (especially useful if you’re using non-English characters)</li>
<li>A <code>boundary</code> pattern can match the breaks between words, lines, characters, or sentences. By convention <code>""</code> is used as shorthand for <code>boundary("character")</code></li>
<li>A <code>regex</code> (the default throughout <strong>stringr</strong>) is a regular expression</li>
</ul>
<p>I’ll start out giving an example that uses <code>boundary</code>, but for the most part I’ll use <code>fixed</code> expressions. I’ll leave regular expressions for the very end - they’re easily the most powerful tool but also the most complicated.</p>
</div>
</div>
<div id="splitting-strings" class="section level2">
<h2><span class="header-section-number">17.13</span> Splitting strings</h2>
<p>To give a sense of how we might want to use <code>str_split()</code> to break up strings, let suppose I want to take the start of <em>Pride and Prejudice</em> and split it up by word, character, or sentence. First, I’ll need to define it:</p>
<pre class="r"><code>truth &lt;- &quot;It is a truth universally acknowledged, that a single man in possession of a good fortune, must be in want of a wife. However little known the feelings or views of such a man may be on his first entering a neighbourhood, this truth is so well fixed in the minds of the surrounding families, that he is considered the rightful property of some one or other of their daughters.&quot;</code></pre>
<p>Now, if I want to break this up, the <em>task</em> I need to solve is governed by the <code>str_split()</code> function, but the three goals I’ve set myself all relate to a <code>boundary()</code> pattern of some kind, so that’s the <em>engine</em> I’ll use. So the commands I need here would be:</p>
<pre class="r"><code>truth %&gt;% str_split(pattern = boundary(&quot;word&quot;))
truth %&gt;% str_split(pattern = boundary(&quot;character&quot;))
truth %&gt;% str_split(pattern = boundary(&quot;sentence&quot;))</code></pre>
<pre><code>## [[1]]
##  [1] &quot;It&quot;            &quot;is&quot;            &quot;a&quot;            
##  [4] &quot;truth&quot;         &quot;universally&quot;   &quot;acknowledged&quot; 
##  [7] &quot;that&quot;          &quot;a&quot;             &quot;single&quot;       
## [10] &quot;man&quot;           &quot;in&quot;            &quot;possession&quot;   
## [13] &quot;of&quot;            &quot;a&quot;             &quot;good&quot;         
## [16] &quot;fortune&quot;       &quot;must&quot;          &quot;be&quot;           
## [19] &quot;in&quot;            &quot;want&quot;          &quot;of&quot;           
## [22] &quot;a&quot;             &quot;wife&quot;          &quot;However&quot;      
## [25] &quot;little&quot;        &quot;known&quot;         &quot;the&quot;          
## [28] &quot;feelings&quot;      &quot;or&quot;            &quot;views&quot;        
## [31] &quot;of&quot;            &quot;such&quot;          &quot;a&quot;            
## [34] &quot;man&quot;           &quot;may&quot;           &quot;be&quot;           
## [37] &quot;on&quot;            &quot;his&quot;           &quot;first&quot;        
## [40] &quot;entering&quot;      &quot;a&quot;             &quot;neighbourhood&quot;
## [43] &quot;this&quot;          &quot;truth&quot;         &quot;is&quot;           
## [46] &quot;so&quot;            &quot;well&quot;          &quot;fixed&quot;        
## [49] &quot;in&quot;            &quot;the&quot;           &quot;minds&quot;        
## [52] &quot;of&quot;            &quot;the&quot;           &quot;surrounding&quot;  
## [55] &quot;families&quot;      &quot;that&quot;          &quot;he&quot;           
## [58] &quot;is&quot;            &quot;considered&quot;    &quot;the&quot;          
## [61] &quot;rightful&quot;      &quot;property&quot;      &quot;of&quot;           
## [64] &quot;some&quot;          &quot;one&quot;           &quot;or&quot;           
## [67] &quot;other&quot;         &quot;of&quot;            &quot;their&quot;        
## [70] &quot;daughters&quot;    
## 
## [[1]]
##   [1] &quot;I&quot; &quot;t&quot; &quot; &quot; &quot;i&quot; &quot;s&quot; &quot; &quot; &quot;a&quot; &quot; &quot; &quot;t&quot; &quot;r&quot; &quot;u&quot; &quot;t&quot; &quot;h&quot; &quot; &quot;
##  [15] &quot;u&quot; &quot;n&quot; &quot;i&quot; &quot;v&quot; &quot;e&quot; &quot;r&quot; &quot;s&quot; &quot;a&quot; &quot;l&quot; &quot;l&quot; &quot;y&quot; &quot; &quot; &quot;a&quot; &quot;c&quot;
##  [29] &quot;k&quot; &quot;n&quot; &quot;o&quot; &quot;w&quot; &quot;l&quot; &quot;e&quot; &quot;d&quot; &quot;g&quot; &quot;e&quot; &quot;d&quot; &quot;,&quot; &quot; &quot; &quot;t&quot; &quot;h&quot;
##  [43] &quot;a&quot; &quot;t&quot; &quot; &quot; &quot;a&quot; &quot; &quot; &quot;s&quot; &quot;i&quot; &quot;n&quot; &quot;g&quot; &quot;l&quot; &quot;e&quot; &quot; &quot; &quot;m&quot; &quot;a&quot;
##  [57] &quot;n&quot; &quot; &quot; &quot;i&quot; &quot;n&quot; &quot; &quot; &quot;p&quot; &quot;o&quot; &quot;s&quot; &quot;s&quot; &quot;e&quot; &quot;s&quot; &quot;s&quot; &quot;i&quot; &quot;o&quot;
##  [71] &quot;n&quot; &quot; &quot; &quot;o&quot; &quot;f&quot; &quot; &quot; &quot;a&quot; &quot; &quot; &quot;g&quot; &quot;o&quot; &quot;o&quot; &quot;d&quot; &quot; &quot; &quot;f&quot; &quot;o&quot;
##  [85] &quot;r&quot; &quot;t&quot; &quot;u&quot; &quot;n&quot; &quot;e&quot; &quot;,&quot; &quot; &quot; &quot;m&quot; &quot;u&quot; &quot;s&quot; &quot;t&quot; &quot; &quot; &quot;b&quot; &quot;e&quot;
##  [99] &quot; &quot; &quot;i&quot; &quot;n&quot; &quot; &quot; &quot;w&quot; &quot;a&quot; &quot;n&quot; &quot;t&quot; &quot; &quot; &quot;o&quot; &quot;f&quot; &quot; &quot; &quot;a&quot; &quot; &quot;
## [113] &quot;w&quot; &quot;i&quot; &quot;f&quot; &quot;e&quot; &quot;.&quot; &quot; &quot; &quot;H&quot; &quot;o&quot; &quot;w&quot; &quot;e&quot; &quot;v&quot; &quot;e&quot; &quot;r&quot; &quot; &quot;
## [127] &quot;l&quot; &quot;i&quot; &quot;t&quot; &quot;t&quot; &quot;l&quot; &quot;e&quot; &quot; &quot; &quot;k&quot; &quot;n&quot; &quot;o&quot; &quot;w&quot; &quot;n&quot; &quot; &quot; &quot;t&quot;
## [141] &quot;h&quot; &quot;e&quot; &quot; &quot; &quot;f&quot; &quot;e&quot; &quot;e&quot; &quot;l&quot; &quot;i&quot; &quot;n&quot; &quot;g&quot; &quot;s&quot; &quot; &quot; &quot;o&quot; &quot;r&quot;
## [155] &quot; &quot; &quot;v&quot; &quot;i&quot; &quot;e&quot; &quot;w&quot; &quot;s&quot; &quot; &quot; &quot;o&quot; &quot;f&quot; &quot; &quot; &quot;s&quot; &quot;u&quot; &quot;c&quot; &quot;h&quot;
## [169] &quot; &quot; &quot;a&quot; &quot; &quot; &quot;m&quot; &quot;a&quot; &quot;n&quot; &quot; &quot; &quot;m&quot; &quot;a&quot; &quot;y&quot; &quot; &quot; &quot;b&quot; &quot;e&quot; &quot; &quot;
## [183] &quot;o&quot; &quot;n&quot; &quot; &quot; &quot;h&quot; &quot;i&quot; &quot;s&quot; &quot; &quot; &quot;f&quot; &quot;i&quot; &quot;r&quot; &quot;s&quot; &quot;t&quot; &quot; &quot; &quot;e&quot;
## [197] &quot;n&quot; &quot;t&quot; &quot;e&quot; &quot;r&quot; &quot;i&quot; &quot;n&quot; &quot;g&quot; &quot; &quot; &quot;a&quot; &quot; &quot; &quot;n&quot; &quot;e&quot; &quot;i&quot; &quot;g&quot;
## [211] &quot;h&quot; &quot;b&quot; &quot;o&quot; &quot;u&quot; &quot;r&quot; &quot;h&quot; &quot;o&quot; &quot;o&quot; &quot;d&quot; &quot;,&quot; &quot; &quot; &quot;t&quot; &quot;h&quot; &quot;i&quot;
## [225] &quot;s&quot; &quot; &quot; &quot;t&quot; &quot;r&quot; &quot;u&quot; &quot;t&quot; &quot;h&quot; &quot; &quot; &quot;i&quot; &quot;s&quot; &quot; &quot; &quot;s&quot; &quot;o&quot; &quot; &quot;
## [239] &quot;w&quot; &quot;e&quot; &quot;l&quot; &quot;l&quot; &quot; &quot; &quot;f&quot; &quot;i&quot; &quot;x&quot; &quot;e&quot; &quot;d&quot; &quot; &quot; &quot;i&quot; &quot;n&quot; &quot; &quot;
## [253] &quot;t&quot; &quot;h&quot; &quot;e&quot; &quot; &quot; &quot;m&quot; &quot;i&quot; &quot;n&quot; &quot;d&quot; &quot;s&quot; &quot; &quot; &quot;o&quot; &quot;f&quot; &quot; &quot; &quot;t&quot;
## [267] &quot;h&quot; &quot;e&quot; &quot; &quot; &quot;s&quot; &quot;u&quot; &quot;r&quot; &quot;r&quot; &quot;o&quot; &quot;u&quot; &quot;n&quot; &quot;d&quot; &quot;i&quot; &quot;n&quot; &quot;g&quot;
## [281] &quot; &quot; &quot;f&quot; &quot;a&quot; &quot;m&quot; &quot;i&quot; &quot;l&quot; &quot;i&quot; &quot;e&quot; &quot;s&quot; &quot;,&quot; &quot; &quot; &quot;t&quot; &quot;h&quot; &quot;a&quot;
## [295] &quot;t&quot; &quot; &quot; &quot;h&quot; &quot;e&quot; &quot; &quot; &quot;i&quot; &quot;s&quot; &quot; &quot; &quot;c&quot; &quot;o&quot; &quot;n&quot; &quot;s&quot; &quot;i&quot; &quot;d&quot;
## [309] &quot;e&quot; &quot;r&quot; &quot;e&quot; &quot;d&quot; &quot; &quot; &quot;t&quot; &quot;h&quot; &quot;e&quot; &quot; &quot; &quot;r&quot; &quot;i&quot; &quot;g&quot; &quot;h&quot; &quot;t&quot;
## [323] &quot;f&quot; &quot;u&quot; &quot;l&quot; &quot; &quot; &quot;p&quot; &quot;r&quot; &quot;o&quot; &quot;p&quot; &quot;e&quot; &quot;r&quot; &quot;t&quot; &quot;y&quot; &quot; &quot; &quot;o&quot;
## [337] &quot;f&quot; &quot; &quot; &quot;s&quot; &quot;o&quot; &quot;m&quot; &quot;e&quot; &quot; &quot; &quot;o&quot; &quot;n&quot; &quot;e&quot; &quot; &quot; &quot;o&quot; &quot;r&quot; &quot; &quot;
## [351] &quot;o&quot; &quot;t&quot; &quot;h&quot; &quot;e&quot; &quot;r&quot; &quot; &quot; &quot;o&quot; &quot;f&quot; &quot; &quot; &quot;t&quot; &quot;h&quot; &quot;e&quot; &quot;i&quot; &quot;r&quot;
## [365] &quot; &quot; &quot;d&quot; &quot;a&quot; &quot;u&quot; &quot;g&quot; &quot;h&quot; &quot;t&quot; &quot;e&quot; &quot;r&quot; &quot;s&quot; &quot;.&quot;
## 
## [[1]]
## [1] &quot;It is a truth universally acknowledged, that a single man in possession of a good fortune, must be in want of a wife. &quot;                                                                                                                                           
## [2] &quot;However little known the feelings or views of such a man may be on his first entering a neighbourhood, this truth is so well fixed in the minds of the surrounding families, that he is considered the rightful property of some one or other of their daughters.&quot;</code></pre>
</div>
<div id="count-detect-subset" class="section level2">
<h2><span class="header-section-number">17.14</span> Count, detect, subset</h2>
<p>Suppose I would like to look at the presence of the string <code>"ni"</code> within each of the <code>input</code> words. It’s a specific piece of text, so we’ll use <code>fixed("ni")</code> to specify the pattern. There are a few different tasks we might want to complete. We could count the <em>number</em> of times <code>"ni"</code> appears in every word (a job for <code>str_count</code>), we could ask <em>whether</em> the string <code>"ni"</code> appears in each word (a job for <code>str_detect</code>), or we could ask <em>which</em> of the words contain <code>"ni"</code>. That leads to the following commands:</p>
<pre class="r"><code>input %&gt;% str_count(pattern = fixed(&quot;ni&quot;))</code></pre>
<pre><code>##  [1] 1 0 0 1 1 0 0 1 0 1 0 0 0 1 2 0 1 0 0 0 0 0 1 0 0 1 1</code></pre>
<pre class="r"><code>input %&gt;% str_detect(pattern = fixed(&quot;ni&quot;))</code></pre>
<pre><code>##  [1]  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE  TRUE
## [11] FALSE FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE
## [21] FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE</code></pre>
<pre class="r"><code>input %&gt;% str_subset(pattern = fixed(&quot;ni&quot;))</code></pre>
<pre><code>##  [1] &quot;kinimapi&quot; &quot;miwiniku&quot; &quot;pinipi&quot;   &quot;nipi&quot;     &quot;nihepi&quot;  
##  [6] &quot;miniki&quot;   &quot;gepinini&quot; &quot;nipikuge&quot; &quot;kunige&quot;   &quot;winige&quot;  
## [11] &quot;kinimage&quot;</code></pre>
</div>
<div id="locate" class="section level2">
<h2><span class="header-section-number">17.15</span> Locate</h2>
<pre class="r"><code>&quot;gepinini&quot; %&gt;% str_locate(fixed(&quot;ni&quot;))</code></pre>
<pre><code>##      start end
## [1,]     5   6</code></pre>
<pre class="r"><code>&quot;gepinini&quot; %&gt;% str_locate_all(fixed(&quot;ni&quot;))</code></pre>
<pre><code>## [[1]]
##      start end
## [1,]     5   6
## [2,]     7   8</code></pre>
</div>
<div id="extract-remove-replace" class="section level2">
<h2><span class="header-section-number">17.16</span> Extract, remove, replace</h2>
<p>The last group of pattern matching functions I want talk about are those that <em>extract</em>, <em>remove</em> or <em>replace</em> parts of strings that match a pattern. To get the most out of these functions, it’s useful to switch to <em>regular expressions</em> to define patterns. Regular expressions are complicated things and I won’t even try to do anything but the most basic tasks with the. To start with, consider this:</p>
<pre class="r"><code>vowels &lt;- regex(&quot;[aeiouAEIOU]&quot;)</code></pre>
<p>Setting aside the details of how it works, you might guess that this is an expression that matches vowels. So if we take the opening passage to <em>Pride and Prejudice</em> and do this</p>
<pre class="r"><code>truth %&gt;% str_remove_all(pattern = vowels) </code></pre>
<pre><code>## [1] &quot;t s  trth nvrslly cknwldgd, tht  sngl mn n pssssn f  gd frtn, mst b n wnt f  wf. Hwvr lttl knwn th flngs r vws f sch  mn my b n hs frst ntrng  nghbrhd, ths trth s s wll fxd n th mnds f th srrndng fmls, tht h s cnsdrd th rghtfl prprty f sm n r thr f thr dghtrs.&quot;</code></pre>
<p>we end up with output that removes all the vowels. Alternatively, we could replace all the vowels with periods using this command</p>
<pre class="r"><code>truth %&gt;% str_replace_all(pattern = vowels, replacement = fixed(&quot;.&quot;)) </code></pre>
<pre><code>## [1] &quot;.t .s . tr.th .n.v.rs.lly .ckn.wl.dg.d, th.t . s.ngl. m.n .n p.ss.ss..n .f . g..d f.rt.n., m.st b. .n w.nt .f . w.f.. H.w.v.r l.ttl. kn.wn th. f..l.ngs .r v..ws .f s.ch . m.n m.y b. .n h.s f.rst .nt.r.ng . n..ghb..rh..d, th.s tr.th .s s. w.ll f.x.d .n th. m.nds .f th. s.rr..nd.ng f.m.l..s, th.t h. .s c.ns.d.r.d th. r.ghtf.l pr.p.rty .f s.m. .n. .r .th.r .f th..r d..ght.rs.&quot;</code></pre>
<p>Finally, we could use a command like this to extract all the vowels from <code>truth</code>:</p>
<pre class="r"><code>truth %&gt;% str_extract_all(pattern = vowels) </code></pre>
<pre><code>## [[1]]
##   [1] &quot;I&quot; &quot;i&quot; &quot;a&quot; &quot;u&quot; &quot;u&quot; &quot;i&quot; &quot;e&quot; &quot;a&quot; &quot;a&quot; &quot;o&quot; &quot;e&quot; &quot;e&quot; &quot;a&quot; &quot;a&quot;
##  [15] &quot;i&quot; &quot;e&quot; &quot;a&quot; &quot;i&quot; &quot;o&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;o&quot; &quot;a&quot; &quot;o&quot; &quot;o&quot; &quot;o&quot; &quot;u&quot;
##  [29] &quot;e&quot; &quot;u&quot; &quot;e&quot; &quot;i&quot; &quot;a&quot; &quot;o&quot; &quot;a&quot; &quot;i&quot; &quot;e&quot; &quot;o&quot; &quot;e&quot; &quot;e&quot; &quot;i&quot; &quot;e&quot;
##  [43] &quot;o&quot; &quot;e&quot; &quot;e&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;i&quot; &quot;e&quot; &quot;o&quot; &quot;u&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;e&quot;
##  [57] &quot;o&quot; &quot;i&quot; &quot;i&quot; &quot;e&quot; &quot;e&quot; &quot;i&quot; &quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot; &quot;o&quot; &quot;o&quot; &quot;i&quot;
##  [71] &quot;u&quot; &quot;i&quot; &quot;o&quot; &quot;e&quot; &quot;i&quot; &quot;e&quot; &quot;i&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;e&quot; &quot;u&quot; &quot;o&quot; &quot;u&quot;
##  [85] &quot;i&quot; &quot;a&quot; &quot;i&quot; &quot;i&quot; &quot;e&quot; &quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;i&quot; &quot;e&quot; &quot;e&quot; &quot;e&quot; &quot;i&quot;
##  [99] &quot;u&quot; &quot;o&quot; &quot;e&quot; &quot;o&quot; &quot;o&quot; &quot;e&quot; &quot;o&quot; &quot;e&quot; &quot;o&quot; &quot;o&quot; &quot;e&quot; &quot;o&quot; &quot;e&quot; &quot;i&quot;
## [113] &quot;a&quot; &quot;u&quot; &quot;e&quot;</code></pre>
</div>
<div id="regular-expressions" class="section level2">
<h2><span class="header-section-number">17.17</span> Regular expressions</h2>
<ul>
<li>quick intro here</li>
</ul>
</div>
<div id="an-example" class="section level2">
<h2><span class="header-section-number">17.18</span> An example</h2>
<p>Okay, so now I should be able to do neat things with the whole novel. Let’s start by gluing the <code>pp</code> vector into one long string, since the line breaks don’t seem to appear at any interesting locations</p>
<pre class="r"><code>pp &lt;- janeaustenr::prideprejudice %&gt;%
  str_flatten(&quot; &quot;) %&gt;%
  str_squish</code></pre>
<p>Okay, so now I want to give myself something to <em>do</em> with this. I’m tired and sick and I can’t think of anything clever, so I’ll just try and locate every appearance of the words <code>"Elizabeth"</code>, <code>"Darcy"</code> and <code>"Wickham"</code> in the text:</p>
<pre class="r"><code>characters &lt;- regex(&quot;Elizabeth|Darcy|Wickham&quot;)
x &lt;- pp %&gt;% str_extract_all(characters) 
y &lt;- pp %&gt;% str_locate_all(characters) 
df &lt;- tibble(character = x[[1]], location = y[[1]][,1] / str_length(pp))
df %&gt;% ggplot(aes(x = location)) +
  facet_wrap(~ character) +
  geom_histogram(bins = 5)</code></pre>
<p><img src="working-with-text_files/figure-html/unnamed-chunk-26-1.png" width="456" style="display: block; margin: auto;" /></p>
<p>No surprises there: <code>Elizabeth</code> occurs most frequently, and at the most uniform rate. At the start of the book <code>Darcy</code> appears just as often, but then there are sections of the book that don’t concern him and the function flatlines for a while. <code>Wickham</code> is absent more often than not.</p>
</div>
<div id="more-resources" class="section level2">
<h2><span class="header-section-number">17.19</span> More resources</h2>
<ul>
<li>The <a href="https://stringr.tidyverse.org/">stringr</a> package</li>
<li>The glue package</li>
<li><a href="https://www.tidytextmining.com/">Text Mining with R</a> by Julia Silge and David Robinson</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
